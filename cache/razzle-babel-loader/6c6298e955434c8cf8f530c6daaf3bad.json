{"ast":null,"code":"var _jsxFileName = \"/home/bon/Documents/projects/spike/material-razzle/src/server/razzle.tsx\";\nvar __jsx = React.createElement;\nimport express from 'express';\nimport React from 'react';\nimport { renderToString } from 'react-dom/server';\nimport { StaticRouter } from 'react-router-dom';\nimport App from '../browser/App';\nconsole.log(process.env);\n\nconst createMarkup = (context, url) => renderToString(__jsx(StaticRouter, {\n  context: context,\n  location: url,\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 9,\n    columnNumber: 5\n  }\n}, __jsx(App, {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 10,\n    columnNumber: 7\n  }\n})));\n\nconst renderPage = (markup, assets) => `<!doctype html>\n  <html lang=\"\">\n  <head>\n      <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" />\n      <meta charSet='utf-8' />\n      <title>Razzle TypeScript</title>\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n      ${assets.client.css ? `<link rel=\"stylesheet\" href=\"${assets.client.css}\">` : ''}\n        ${false ? `<script src=\"${assets.client.js}\" defer></script>` : `<script src=\"${assets.client.js}\" defer crossorigin></script>`}\n  </head>\n  <body>\n      <div id=\"root\">${markup}</div>\n      \n  </body>\n  <src>\n        window.env={foo:'bar'}\n      </src>\n</html>`;\n\nexport default (server => {\n  let assets;\n\n  const syncLoadAssets = () => {\n    assets = require(process.env.RAZZLE_ASSETS_MANIFEST);\n  };\n\n  syncLoadAssets();\n\n  const serveIndex = (req, res) => {\n    const context = {};\n    const markup = createMarkup(context, req.url);\n    const page = renderPage(markup, assets);\n    res.send(page);\n  };\n\n  server.use('/static', express.static('build/public/static'));\n  server.get('/*', serveIndex);\n  server.disable('x-powered-by');\n});","map":{"version":3,"sources":["/home/bon/Documents/projects/spike/material-razzle/src/server/razzle.tsx"],"names":["express","React","renderToString","StaticRouter","App","console","log","process","env","createMarkup","context","url","renderPage","markup","assets","client","css","js","server","syncLoadAssets","require","RAZZLE_ASSETS_MANIFEST","serveIndex","req","res","page","send","use","static","get","disable"],"mappings":";;AAAA,OAAOA,OAAP,MAAoD,SAApD;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,cAAT,QAA+B,kBAA/B;AACA,SAASC,YAAT,QAA6B,kBAA7B;AACA,OAAOC,GAAP,MAAgB,gBAAhB;AACAC,OAAO,CAACC,GAAR,CAAYC,OAAO,CAACC,GAApB;;AACA,MAAMC,YAAY,GAAG,CAACC,OAAD,EAAeC,GAAf,KACnBT,cAAc,CACZ,MAAC,YAAD;AAAc,EAAA,OAAO,EAAEQ,OAAvB;AAAgC,EAAA,QAAQ,EAAEC,GAA1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GACE,MAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EADF,CADY,CADhB;;AAOA,MAAMC,UAAU,GAAG,CAACC,MAAD,EAAiBC,MAAjB,KAAkC;AACrD;AACA;AACA;AACA;AACA;AACA;AACA,QACQA,MAAM,CAACC,MAAP,CAAcC,GAAd,GACK,gCAA+BF,MAAM,CAACC,MAAP,CAAcC,GAAI,IADtD,GAEI,EACL;AACP,UACU,QACK,gBAAeF,MAAM,CAACC,MAAP,CAAcE,EAAG,mBADrC,GAEK,gBAAeH,MAAM,CAACC,MAAP,CAAcE,EAAG,+BACtC;AACT;AACA;AACA,uBAAuBJ,MAAO;AAC9B;AACA;AACA;AACA;AACA;AACA,QAzBA;;AA2BA,gBAAgBK,MAAD,IAAqB;AAClC,MAAIJ,MAAJ;;AAEA,QAAMK,cAAc,GAAG,MAAM;AAC3BL,IAAAA,MAAM,GAAGM,OAAO,CAACb,OAAO,CAACC,GAAR,CAAYa,sBAAb,CAAhB;AACD,GAFD;;AAGAF,EAAAA,cAAc;;AAEd,QAAMG,UAAU,GAAG,CAACC,GAAD,EAAeC,GAAf,KAAiC;AAClD,UAAMd,OAAO,GAAG,EAAhB;AACA,UAAMG,MAAM,GAAGJ,YAAY,CAACC,OAAD,EAAUa,GAAG,CAACZ,GAAd,CAA3B;AACA,UAAMc,IAAI,GAAGb,UAAU,CAACC,MAAD,EAASC,MAAT,CAAvB;AACAU,IAAAA,GAAG,CAACE,IAAJ,CAASD,IAAT;AACD,GALD;;AAOAP,EAAAA,MAAM,CAACS,GAAP,CAAW,SAAX,EAAsB3B,OAAO,CAAC4B,MAAR,CAAe,qBAAf,CAAtB;AAEAV,EAAAA,MAAM,CAACW,GAAP,CAAW,IAAX,EAAiBP,UAAjB;AAEAJ,EAAAA,MAAM,CAACY,OAAP,CAAe,cAAf;AACD,CApBD","sourcesContent":["import express, { Express, Request, Response } from 'express';\nimport React from 'react';\nimport { renderToString } from 'react-dom/server';\nimport { StaticRouter } from 'react-router-dom';\nimport App from '../browser/App';\nconsole.log(process.env);\nconst createMarkup = (context: any, url: string) =>\n  renderToString(\n    <StaticRouter context={context} location={url}>\n      <App />\n    </StaticRouter>\n  );\n\nconst renderPage = (markup: string, assets: any) => `<!doctype html>\n  <html lang=\"\">\n  <head>\n      <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" />\n      <meta charSet='utf-8' />\n      <title>Razzle TypeScript</title>\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n      ${\n        assets.client.css\n          ? `<link rel=\"stylesheet\" href=\"${assets.client.css}\">`\n          : ''\n      }\n        ${\n          process.env.NODE_ENV === 'production'\n            ? `<script src=\"${assets.client.js}\" defer></script>`\n            : `<script src=\"${assets.client.js}\" defer crossorigin></script>`\n        }\n  </head>\n  <body>\n      <div id=\"root\">${markup}</div>\n      \n  </body>\n  <src>\n        window.env={foo:'bar'}\n      </src>\n</html>`;\n\nexport default (server: Express) => {\n  let assets: any;\n\n  const syncLoadAssets = () => {\n    assets = require(process.env.RAZZLE_ASSETS_MANIFEST!);\n  };\n  syncLoadAssets();\n\n  const serveIndex = (req: Request, res: Response) => {\n    const context = {};\n    const markup = createMarkup(context, req.url);\n    const page = renderPage(markup, assets);\n    res.send(page);\n  };\n\n  server.use('/static', express.static('build/public/static'));\n\n  server.get('/*', serveIndex);\n\n  server.disable('x-powered-by');\n};\n"]},"metadata":{},"sourceType":"module"}